version: "3.8"

services:
  user-service:
    build:
      context: ./user-service
      dockerfile: Dockerfile
    env_file:
      - ./user-service/.env
    container_name: user-service
    ports:
      - 3001:3001
    networks:
      - peerprepnet

  question-service:
    build:
      context: ./question-service/backend
      dockerfile: Dockerfile
    env_file:
      - ./question-service/backend/.env
    container_name: question-service
    ports:
      - 8080:8080
    networks:
      - peerprepnet

  frontend-react:
    build:
      context: ./frontend/frontend_app
      dockerfile: Dockerfile
    container_name: frontend-react
    networks:
      - peerprepnet

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - 8000:8000
    # env_file:
    #   - ./frontend/.env
    container_name: frontend
    depends_on:
      - user-service
      - question-service
      - frontend-react
    networks:
      - peerprepnet
    
  collaboration-service:
    build:
      context: ./collaboration-service/collaborative-editor-backend
      dockerfile: Dockerfile
    ports:
      - 4001:4001
    # env_file:
    #   - ./frontend/.env
    container_name: collaboratioon-service
    depends_on:
      - question-service
    networks:
      - peerprepnet

  
  rabbitmq:
    image: rabbitmq:3-management
    ports: 
      - 5672:5672
      - 15672:15672
    networks:
      - peerprepnet
    container_name: rabbitmq

  matching-service:
    build:
      context: ./matching-service
      dockerfile: Dockerfile
    env_file:
      - ./matching-service/.env
    container_name: matching-service
    ports:
      - 3002:3002
    depends_on:
      - rabbitmq
    networks:
      - peerprepnet

    
networks:
  peerprepnet:
    name: peerprepnet